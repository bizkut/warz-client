<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>FAQ</title><link rel="stylesheet" href="ts3doc.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.74.0"><link rel="home" href="index.html" title="TeamSpeak 3 Server SDK Developer Manual"><link rel="up" href="index.html" title="TeamSpeak 3 Server SDK Developer Manual"><link rel="prev" href="ar01s14.html" title="Miscellaneous functions"><link rel="next" href="ix01.html" title="Index"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><img id="logo" src="images/logo.png"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">FAQ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s14.html"><img src="images/prev.png" alt="Prev"></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ix01.html"><img src="images/next.png" alt="Next"></a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="s_faq"></a>FAQ</h2></div></div></div><div class="itemizedlist"><ul type="disc"><li><p><a class="link" href="ar01s15.html#s_faq_1" title="I cannot start multiple server processes? I cannot start more than one virtual server?">I cannot start multiple server processes? I cannot start more than one virtual server?</a></p></li><li><p><a class="link" href="ar01s15.html#s_faq_2" title="How can I configure the maximum number of slots?">How can I configure the maximum number of slots?</a></p></li><li><p><a class="link" href="ar01s15.html#s_faq_3" title='I get "Accounting | | sid=1 is running" "initializing shutdown" in the log'>I get "Accounting | | sid=1 is running" "initializing shutdown" in the log</a></p></li><li><p><a class="link" href="ar01s15.html#s_faq_4" title="How to implement a name/password authentication?">How to implement a name/password authentication?</a></p></li></ul></div><div class="literallayout"><p><br>
</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s_faq_1"></a>I cannot start multiple server processes? I cannot start more than one virtual server?</h3></div></div></div><p>You don't have a valid license key in the correct location. The file <code class="filename">licensekey.dat</code> needs to be placed in the same directory as your server executable. If no or an invalid license key is present, the server will run with the following restrictions:
</p><div class="itemizedlist"><ul type="disc"><li><p>Only one server process per machine</p></li><li><p>Only one virtual server per process</p></li><li><p>Only 32 slots</p></li></ul></div><p>
</p><p>Please contact <code class="email">&lt;<a class="email" href="mailto:sales@tritoncia.com">sales@tritoncia.com</a>&gt;</code> about license key inquiries or to obtain a valid license.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s_faq_2"></a>How can I configure the maximum number of slots?</h3></div></div></div><p>The number of slots per virtual server can be changed by setting the virtual server property <em class="structfield"><code>VIRTUALSERVER_MAXCLIENTS</code></em>.</p><p>Example to set 100 slots on the specified virtual server:</p><pre class="programlisting">ts3server_setVirtualServerVariableAsInt(serverID, VIRTUALSERVER_MAXCLIENTS, 100);  // Set value
ts3server_flushVirtualServerVariable(serverID);  // Flush value</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p> Please note that you probably do not have unlimited slots allowed by your license, so don't set this arbitrarily.</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s_faq_3"></a>I get "Accounting | | sid=1 is running" "initializing shutdown" in the log</h3></div></div></div><p>This error does not occur because you are exceeding your licensed server or slot count, but rather because you are running more than one instance of a virtual server with the same server keypair.</p><p>When creating a new virtual server, a keypair must be passed to <a class="link" href="ar01s10.html" title="Create and stop virtual servers"><code class="function">ts3server_createVirtualServer</code></a>. It is important to store the used keypair and reuse it when restarting this virtual server later instead of creating a new key. See the server sample within the SDK for an example.</p><p>However, above problem can happen if the virtual server is started with a stored keypair, then the entire folder including the stored keypair is copied to another PC and also started there with the <span class="emphasis"><em>same</em></span> key. In this case the licensing server will notice the same key is used more than once after one hour and shutdown the most recently started server which tried to steal the identity of an already running server.</p><p>The fix, in the server sample case, would be to delete the keypair_*.txt files from the copied directory before starting the second server, that way a new key would be generated and the licensing server would see the two servers as two valid different entities. The accounting server would now only complain if the number of simultaneously running servers exceeds your number of slots.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="s_faq_4"></a>How to implement a name/password authentication?</h3></div></div></div><p>Although TeamSpeak 3 offers an authentication system based on public/private keys, an often made request is to use an additional login name/password mechanism to authenticate clients with the TeamSpeak 3 server. Here we will suggest a possibility to implement this authentication on top of the existing public/private key mechanism.</p><p>When connecting to the TeamSpeak 3 server, a client might make use of the CLIENT_META_DATA property and fill this with a name/password combination to let the server validate this this data in the servers <code class="function">onClientConnected</code> callback. This callback allows to set an error value to block this clients connection.</p><p>The client-side code:</p><pre class="programlisting">// In the client, set CLIENT_META_DATA before connecting
if(ts3client_setClientSelfVariableAsString(scHandlerID, CLIENT_META_DATA, "NAME#PASSWORD") != ERROR_ok) {
    printf("Failed setting client meta data\n");
    return;
}

// Call ts3client_startConnection</pre><p>In the server implement the onClientConnected callback, which validates the name/password meta data and refuses the connection if not validated:</p><pre class="programlisting">void onClientConnected(uint64 serverID, anyID clientID, uint64 channelID, unsigned int* removeClientError) {
    // Query CLIENT_META_DATA
    char* metaData;
    if(ts3server_getClientVariableAsString(serverID, clientID, CLIENT_META_DATA, &amp;metaData) != ERROR_ok) {
        printf("Failed querying client meta data\n");
        *removeClientError = ERROR_client_not_logged_in;  // Block client
        return;
    }

    // Validate name/password
    if(!validateNamePassword(metaData)) {
        *removeClientError = ERROR_client_not_logged_in;  // Block client
    }
    // Client is allowed to connect if removeClientError is not changed
    // (defaults is ERROR_ok)
    ts3server_freeMemory(metaData);  // Release previously allocated memory
}</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s14.html"><img src="images/prev.png" alt="Prev"></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ix01.html"><img src="images/next.png" alt="Next"></a></td></tr><tr><td width="40%" align="left" valign="top">Miscellaneous functions </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"></a></td><td width="40%" align="right" valign="top"> Index</td></tr></table></div></body></html>
